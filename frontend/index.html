<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <title>Shehab’s 3-Tier Demo</title>
</head>
<body>
  <h1>Hi from Shehab Gamal!</h1>

  <!-- existing: load data -->
  <button id="btn">Load Data</button>
  <ul id="list"></ul>

  <!-- new: insert -->
  <div style="margin-top:12px">
    <input id="newInfo" type="text" placeholder="text to insert…" />
    <button id="btnInsert">Insert</button>
  </div>

  <!-- new: delete -->
  <div style="margin-top:8px">
    <input id="deleteId" type="number" min="1" placeholder="id to delete" />
    <button id="btnDelete">Delete</button>
  </div>

  <script>
    // keep your original loader, wrapped as a function so others can reuse it
    async function loadData() {
      try {
        const resp = await fetch("/api/data");
        if (!resp.ok) throw new Error(resp.statusText);
        const items = await resp.json();
        const ul = document.getElementById("list");
        ul.innerHTML = "";
        items.forEach(o => {
          const li = document.createElement("li");
          li.textContent = `#${o.id}: ${o.info}`;
          ul.appendChild(li);
        });
      } catch (err) {
        alert("Fetch error: " + err);
      }
    }

    // wire your existing button to the same function
    document.getElementById("btn").onclick = loadData;

    // INSERT: POST /api/data with { info }
    document.getElementById("btnInsert").onclick = async () => {
      const info = document.getElementById("newInfo").value.trim();
      if (!info) { alert("Please enter some text."); return; }
      try {
        const resp = await fetch("/api/data", {
          method: "POST",
          headers: { "Content-Type": "application/json" },
          body: JSON.stringify({ info })
        });
        if (!resp.ok) throw new Error(resp.statusText);
        document.getElementById("newInfo").value = "";
        await loadData();
      } catch (err) {
        alert("Insert error: " + err);
      }
    };

    // DELETE: DELETE /api/data/:id
    document.getElementById("btnDelete").onclick = async () => {
      const id = Number(document.getElementById("deleteId").value);
      if (!id) { alert("Enter a valid id."); return; }
      try {
        const resp = await fetch(`/api/data/${id}`, { method: "DELETE" });
        if (!resp.ok) throw new Error(resp.statusText);
        document.getElementById("deleteId").value = "";
        await loadData();
      } catch (err) {
        alert("Delete error: " + err);
      }
    };

    // optional: auto-load on page open
    loadData();
  </script>
</body>
</html>
